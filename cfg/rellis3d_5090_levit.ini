[DIRS]

data_folder= /home/lrm/workspace/Rellis-3D
mapping_path = /home/lrm/workspace/segment_net/params/rellis3d.json
logs= /home/lrm/workspace/segment_net/logs

#not used
metadata_path = /home/lrm/workspace/segment_net/params/rellis3d.json

[MODE]

#[train, resume, test]
mode= train

[SPLITS]

train_seqs= /home/lrm/workspace/Rellis-3D/train.lst

val_seqs= /home/lrm/workspace/Rellis-3D/val.lst

test_sets= /home/lrm/workspace/Rellis-3D/test.lst

[DATA]

# urban datasets:              [bdd100k, a2d2]
# off-road datasets:           [rellis3d, rudg]
# urban and off-road datasets: [goose]
dataset = rellis3d

#number of samples (-1, all)
num_samples=-1
num_samples_plot = 2
batch_size = 64

[TRAIN]

epochs = 100
patience = 5
steps_minibatch_optimizer = 1

[CHECKPOINT]

steps_train = 10
save_best = true
save_last = true
steps_plot_train = 20

[MODEL]

learning_rate = 0.0001
weight_decay = 0.00001
dropout = 0.2
grad_norm = 5.0

#[batch_norm, group_norm]
norm_fn = batch_norm

[BACKBONE]

# convolution: [resnet18, mobilenetv3, efficientnetb0, deeplabv3_mobilenetv3, convnextv2]
# transformer: [deit3_small, sam2_hiera, pitxs, segformerb0, levit, tinyvit, fastvit]
# hybrid: [mobilevit, efficientformer, maxxvitv2, edgenext]
type = levit

fpn_out_channels= 128

#[sum, concat, weighted_sum, max_pool]
aggregate=sum

# resnet18 -> 4 weights
# mobilenetv3 -> 5 weights
# deeplabv3_mobilenetv3 -> 5 weights
# efficientnetb0 -> 4 weights
# deit3_small -> 5 weights
# mobilevit -> 6 weights
# efficientformer -> 4 weights
# segformerb0 -> 4 weights
# pitxs -> 4 weights
# levit -> 4 weights
layer_weights=[2., 1., 1., 2., 1., 1.]

dropout = 0.2

[ATTENTION]

#[none, spatial, query, class_channel, se_channel]
type = query

reduction_rate = 4

dropout = 0.05

[HEAD]

dropout=0.1

#[se_conv_interp, depthwise_nn, transformer]
type=transformer

num_blocks = 2

# optimize classifier for low latency:
# true: conv + interpolation
# false: interpolation + conv
opt_latency = true

num_head_transformer = 4

[LOSS]

# dice, focal_dice, 
# cross_entropy, focal_cross_entropy, 
# lovasz_softmax, boundary_dice,
# hausdorff_dt_dice
type = dice

alpha = 0.25
gamma = 2.0

# "Unknown" :  0,
# "Dirt"    :  1,
# "Grass"   :  2,
# "Tree"    :  3,
# "Pole"    :  4,
# "Water"   :  5,
# "Sky"     :  6,
# "Vehicle" :  7,
# "Object"  :  8,
# "Asphalt" :  9,
# "Building": 10,
# "Log"     : 11,
# "Person"  : 12,
# "Fence"   : 13,
# "Bush"    : 14,
# "Concrete": 15,
# "Barrier" : 16,
# "Puddle"  : 17,
# "Mud"     : 18,
# "Rubble"  : 19 

# Class weights for the image to handle imbalanced distribution
class_weights = [1.0, 1.0, 1.0, 1.0, 1.0, 
                 1.0, 1.0, 1.0, 1.0, 1.0, 
                 1.0, 1.0, 1.0, 1.0, 1.0, 
                 1.0, 1.0, 1.0, 1.0, 1.0]

# value to multiply the loss by
loss_scale = 10.0

[IMAGE]

num_classes = 20

#[width, height] = [960, 604]
#[width, height] = [320, 201]
# rellis (original) = [1920, 1200]
image_size = [640,400]

resize = true


